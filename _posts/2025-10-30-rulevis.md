---
title: "Rulevis released as PyPi package"
tags:
  - Wazuh
  - SIEM
  - Detection
  - Detection Engineering
  - Testing
  - Detection-as-Code

galleryGraph:
  - url: /assets/rulevis-general-view.gif
    image_path: /assets/rulevis-general-view.gif
galleryStats:
  - url: /assets/rulevis-stats-panel.gif
    image_path: /assets/rulevis-stats-panel.gif
galleryHeatmap:
  - url: /assets/rulevis-heatmap-view.gif
    image_path: /assets/rulevis-heatmap-view.gif
---

## RuleVis Released — finally a visual way to untangle Wazuh rules

### Introduction

A while back, when I wrote about how [Wazuh](https://wazuh.com/?utm_source=ambassadors&utm_medium=referral&utm_campaign=ambassadors+program) rules behave more like a graph than a list ([Understanding Wazuh Rules](https://zaferbalkan.com/wazuh-rules/)), I mentioned a quick visualization script I'd hacked together just to stay sane. It showed which rules were connected, which ones escalated endlessly, and which simply sat there doing nothing. I had already named it — not very creatively — RuleVis. After a few people asked for it, I cleaned it up, wrapped it as a proper package, and pushed it to PyPI so others could run it from the command line.

RuleVis turns the Wazuh ruleset into an interactive structure you can actually explore. It parses XML rule files, builds a dependency model, and opens a local browser view so you can move around the hierarchy instead of scrolling through endless markup. You start to see patterns that are almost impossible to spot in raw XML.

Installation is straightforward: `pipx install rulevis` or just `pip install rulevis`. Everything runs locally; no network calls, no external services.

For testing, I pointed it at my own folders:

```bash
rulevis -p C:/Users/zafer/Downloads/wazuh-builtin-rules,C:/Users/zafer/Downloads/wazuh-custom-rules
```

The same syntax works everywhere — just swap in your paths:

```bash
rulevis -p path/to/wazuh/rules,/path/to/custom/rules
```

Once it runs, RuleVis spins up a local Flask app, parses the XMLs, builds the graph in memory, and opens the browser automatically. Logs go where you'd expect: `%LocalAppData%` on Windows, `~/Library/Logs` on macOS, and `~/.local/share` or `$XDG_STATE_HOME` on Linux.

After the initial release, I pushed a couple of tiny patches — **v1.0.2** — mostly to shut up the noisy console logs. Nothing groundbreaking, just a quality-of-life fix.

### Usage

RuleVis has three main views: the **Graph**, the **Statistics panel**, and the **Heatmap**. Each shows a different layer of how your rules behave, and together they make sense of what used to be opaque.

#### Graph

The graph view is what most people start with. It uses a force-directed layout — every rule is a node, every dependency an arrow. Parent–child links, group correlations, threshold relationships: they're all there. You can drag, zoom, and poke at the mess until patterns start to make sense.

{% include gallery id="galleryGraph" caption="Graph view" %}

Click a node to see its metadata — ID, description, groups, and neighbors. That's usually where the first “oh” moments happen: you'll find loops, orphan rules, and odd convergences that you'd never notice in XML.

#### Statistics

The statistics panel puts numbers behind what the graph suggests. It shows which rules are most influential, which act as foundations, and which are just hanging in space. Cycles, isolates, fan-outs — they're all surfaced here.

{% include gallery id="galleryStats" caption="Stats view" %}

Clicking an entry in the stats list jumps you straight to the rule in the graph. I originally wrote it for debugging, but it ended up being the fastest way to verify structure after heavy edits.

#### Heatmap

The heatmap gives a bird's-eye view. It maps rule IDs from 0 to 100,000 and colors regions by density — bright means busy, dark means unused.

{% include gallery id="galleryHeatmap" caption="Heatmap view" %}

This one's handy when planning new custom rules. You instantly see where built-in IDs stop and your own should begin, avoiding overlap and keeping things predictable for shared environments.

### Closing thoughts

RuleVis makes the invisible structure of Wazuh visible. Instead of trawling through XML, you can see the logic as a graph — dependencies, gaps, and all. It doesn't replace understanding the rules, but it helps you reason about them faster.

The code's on [GitHub](https://github.com/zbalkan/rulevis), open-source under MIT, tested on Linux, macOS, and Windows.

**RuleVis** is on [PyPI](https://pypi.org/project/rulevis/). Install it, aim it at your rules, and see what your detection logic really looks like.
And if it breaks, let me know — preferably after I've had coffee.
