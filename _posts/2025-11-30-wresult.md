---
title: "Introducing `wresult`: `GPResult` for Wazuh agents"
tags:
  - Wazuh
  - SIEM
  - Detection
  - Configuration
  - Compliance
  - Reporting
---

Security tools are only as effective in technical capabilities as their configuration. In environments managed with Wazuh, understanding what's actively applied on an agent isn't always straightforward. Wazuh's configuration model is layered: settings come from local files, central manager policies, and condition-based overrides. This flexibility introduces complexity-especially when you need to prove what the agent is doing.

That's the gap `wresult` is meant to address.

## Why This Tool Was Created

Wazuh agents first read `ossec.conf` -the local configuration file. Then, they fetch `agent.conf` from the manager. That file may contain multiple `agent_config` blocks, many of which are conditional based on the agent's name, OS, or profile. These are applied sequentially: later blocks override earlier ones or extend them.

In day-to-day operations, this design works well. But when you need a straight answer-like during an audit or when debugging an issue-it becomes hard to see what's really going on. You can check the files individually, but that doesn't reflect the final, merged result.

I needed something that could give me the **actual, running configuration**-not what's written, but what's applied.

So I built `wresult`.

## What It Does

`wresult` emulates how the Wazuh agent builds its configuration. It reads from:

- `ossec.conf` (local baseline)
- `agent.conf` (centralized policy, with conditional logic)
- `local_internal_options.conf` (optional overrides)
- `client.keys` (to determine agent ID, name, and group context)

It applies the same logic the agent uses: parsing, merging, and filtering based on applicability. The result is a clean, consolidated configuration-what Wazuh would actually run on that endpoint.

You can export it in:

- **JSON**, for automation and integration into validation workflows
- **HTML**, for interactive analysis or printing during audits

The HTML output is styled for usability and includes collapsible sections. It's also print-friendly, with layout adjustments that make the report suitable for A4 export and inclusion in compliance documentation.

## Where It Fits in the Workflow

We've used this during audit preparations and internal reviews. It helps answer questions like:

- Are we monitoring the right paths with File Integrity Monitoring?
- Are log sources from systemd, auditd, and syslog being collected?
- Are there any unintended overrides in agent policy blocks?

Instead of hunting through multiple configuration files and cross-referencing logic, we run a single command and get a verified answer. It's straightforward, transparent, and consistent.

## Installation

```shell
pipx install wresult
```

## Usage

```yaml
usage: wresult [-h] [--output OUTPUT]

Parse the Wazuh agent running configuration, print to stdout as JSON or save to an HTML file.

options:
  -h, --help            show this help message and exit
  --output OUTPUT, -o OUTPUT
                        Output file path
```

### CLI Output (JSON for Automation)

```shell
wresult | jq .
```

üîπ View the exact applied settings in structured JSON, ideal for automation.

<img src="/assets/wresult-console.gif" width="800" alt="Print to console">

### Generate a Human-Readable Report

```shell
wresult --output report.html
```

Generates an interactive HTML report with expandable sections.

<img src="/assets/wresult-file.gif" width="800" alt="Export to HTML file">

See the collapsed tree of configuration items.

<img src="/assets/wresult-collapsed.png" width="800" alt="HTML report with collapsed items">

Click "Show all" to have a broader view.

<img src="/assets/wresult-expanded.png" width="800" alt="HTML report with expanded items">

## A Note on Limitations (and What I'd Prefer)

This tool simulates agent behavior. That means it's only as accurate as our understanding of how the agent resolves and applies configuration logic. If Wazuh changes its internals, this tool may lag behind until updated. That's always a risk with external parsers.

Ideally, the Wazuh agent itself would provide a command-line flag or diagnostic endpoint to return the effective running configuration. That would eliminate the guesswork and make this kind of visibility a native feature. Until then, `wresult` aims to be a faithful approximation.

## Acknowledgments

The HTML report rendering is based on a clever JSON display implementation by [Maxim Maeder](https://maximmaeder.com/display-json-with-html-css-and-javascript). His code provided a great foundation, and I adapted it to match the needs of Wazuh configurations-adding accessibility, print styling, and collapsible views. Thanks to Maxim for making that work available.

## Conclusion

`wresult` solves a narrow but critical problem: understanding the final configuration state of a Wazuh agent. It helps security engineers, compliance teams, and system administrators verify that monitoring rules, log sources, and policy overrides are behaving as intended.

If your team relies on Wazuh for visibility and detection, but you've ever struggled to answer ‚Äúwhat's actually being applied here?‚Äù, this tool can help bridge that gap.

It started as a necessity. Now it's something I rely on. If it helps you too, great.

You can find the code, examples, and install instructions on GitHub.
